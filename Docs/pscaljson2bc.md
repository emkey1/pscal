# pscaljson2bc — Compile AST JSON to Bytecode

## Name

pscaljson2bc — compile AST JSON (from `--dump-ast-json`) into Pscal VM bytecode

## Synopsis

```
pscaljson2bc [--dump-bytecode | --dump-bytecode-only] [-o OUT.bc] [FILE]
pscaljson2bc -h | --help
```

- `FILE`: Path to an AST JSON file. If omitted or set to `-`, reads JSON from stdin.

## Description

`pscaljson2bc` consumes the JSON produced by any front end when invoked with
`--dump-ast-json` and compiles it into Pscal VM bytecode. This enables
pipelines where parsing happens in one process and code generation happens
later or elsewhere.

The tool validates the JSON structure expected by the Pscal AST dumper and
reconstructs an in‑memory AST suitable for code generation.

## Options

- `--dump-bytecode`
  - Disassemble the generated bytecode to stderr before continuing.
- `--dump-bytecode-only`
  - Disassemble the generated bytecode to stderr and exit without writing raw
    bytecode to stdout or `-o`.
- `-o OUT.bc`, `--output OUT.bc`
  - Write raw bytecode to the given file. If omitted, writes to stdout.
- `-h`, `--help`
  - Show a short usage summary and exit.

## Examples

- Compile Pascal source via a JSON pipeline:

```
build/bin/pascal --dump-ast-json Tests/Pascal/BoolTest | \
  build/bin/pscaljson2bc -o out.bc
```

- Disassemble only, from a saved JSON file:

```
build/bin/pscaljson2bc --dump-bytecode-only /path/to/ast.json
```

- Execute generated bytecode:

```
build/bin/pscalvm out.bc
```

- Disassemble a bytecode file:

```
build/bin/pscald out.bc
```

## Exit Status

- `0` on success.
- Non‑zero on input parse errors or code generation failures.

## See Also

- `pascal(1)` — Pascal front end (`--dump-ast-json`)
- `rea(1)`, `clike(1)` — other front ends that can dump AST JSON
- `pscalvm(1)` — execute bytecode
- `pscald(1)` — disassemble bytecode

