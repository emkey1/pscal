program apiSendReceiveTest;

var
  ms: mstream;
  response: string;
  url: string;
  cwd: string;
begin
  cwd := getenv('PWD');
  url := 'file://' + cwd + '/Pascal/apiSendReceiveTest.data';
  ms := apiSend(url, '');
  response := apiReceive(ms);
  if pos('Example Domain', response) = 0 then
  begin
    writeln('Unexpected API response');
    halt(1);
  end;
  writeln('API send/receive test passed');
end.
