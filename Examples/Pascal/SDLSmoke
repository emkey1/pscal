#!/usr/bin/env pascal
program SDLSmoke;
var
  frame: Integer;
  vsyncOn: Boolean;
begin
  // InitGraph3D(WindowWidth, WindowHeight, Title, DepthBits, StencilBits)
  // creates an SDL window with an OpenGL context. Use CloseGraph or
  // CloseGraph3D to tear it down when finished.
  InitGraph3D(640, 480, 'SDL Swap Demo', 24, 8);
  GLSetSwapInterval(1); // start with vsync enabled
  vsyncOn := True;

  for frame := 0 to 599 do
  begin
    // Toggle vsync every two seconds just to demonstrate the new builtin.
    if (frame > 0) and (frame mod 120 = 0) then
    begin
      vsyncOn := not vsyncOn;
      if vsyncOn then
        GLSetSwapInterval(1)
      else
        GLSetSwapInterval(0);
    end;

    // Submit your OpenGL draw calls here before swapping.
    GLSwapWindow;
    GraphLoop(1); // keep the window responsive
  end;

  CloseGraph3D;
end.

