#!/bin/bash
# Set PASCAL to use a different interpreter, e.g.,
#   PASCAL=/path/to/pascal ./tall

ROOT="$(cd "$(dirname "$0")/.." && pwd)"
TESTS="${TESTS:-$ROOT/Tests/Pascal}"  # all your .p / .pas files live here

PASCAL="${PASCAL:-$ROOT/build/bin/pascal}"       # plain interpreter

for f in "$TESTS/TestSuite7.p" \
         "$TESTS/MathSuite01.p" \
         "$TESTS/TestIncDecWithVerify.p" "$TESTS/CaseStatementSuite.p" "$TESTS/BreakLoopTest.p"
do
  [ -r "$f" ] || echo "Missing test file: $f"
done

if [[ ! -x "$PASCAL" ]]; then
  echo "pascal binary not found or not executable: $PASCAL" >&2
  exit 1
fi

run () {
  local label=$1; shift
  echo "=== Starting $label ==="
  "$@"
  echo "=== Finished $label ==="
  echo
}

# ---------- individual suites ----------
run "MDArray"        "$PASCAL" "$TESTS/MultiDimArrayTest.p"
run "TestSuite"      "$PASCAL" "$TESTS/TestSuite7.p"
run "MathSuite"      "$PASCAL" "$TESTS/MathSuite01.p"
run "BitwiseAndExprSuite"      "$PASCAL" "$TESTS/BitwiseAndExprSuite.p"
run "TypeTestSuite"      "$PASCAL" "$TESTS/TypeTestSuite.p"
run "FormattingTestSuite"      "$PASCAL" "$TESTS/FormattingTestSuite.p"
run "TestFileOperations"      "$PASCAL" "$TESTS/TestFileOperations.p"
run "PointerTortureTest"      "$PASCAL" "$TESTS/PointerTortureTest.p"

run "TestIncDecWithVerify.p" "$PASCAL" "$TESTS/TestIncDecWithVerify.p"
run "aseStatementSuite.p" "$PASCAL" "$TESTS/CaseStatementSuite.p"
run "BreakLoopTest.p"  "$PASCAL" "$TESTS/BreakLoopTest.p"

