#!/bin/bash
# Set PASCAL to use a different interpreter, e.g.,
#   PASCAL=/path/to/pascal ./tall

ROOT="$(cd "$(dirname "$0")/.." && pwd)"
TESTS="${TESTS:-$ROOT/Tests/Pascal}"  # all your Pascal test files live here

PASCAL="${PASCAL:-$ROOT/build/bin/pascal}"       # plain interpreter

for f in "$TESTS/TestSuite7" \
         "$TESTS/MathSuite01" \
         "$TESTS/TestIncDecWithVerify" "$TESTS/CaseStatementSuite" "$TESTS/BreakLoopTest"
do
  [ -r "$f" ] || echo "Missing test file: $f"
done

if [[ ! -x "$PASCAL" ]]; then
  echo "pascal binary not found or not executable: $PASCAL" >&2
  exit 1
fi

run () {
  local label=$1; shift
  echo "=== Starting $label ==="
  "$@"
  echo "=== Finished $label ==="
  echo
}

# ---------- individual suites ----------
run "MDArray"        "$PASCAL" "$TESTS/MultiDimArrayTest"
run "TestSuite"      "$PASCAL" "$TESTS/TestSuite7"
run "MathSuite"      "$PASCAL" "$TESTS/MathSuite01"
run "BitwiseAndExprSuite"      "$PASCAL" "$TESTS/BitwiseAndExprSuite"
run "TypeTestSuite"      "$PASCAL" "$TESTS/TypeTestSuite"
run "FormattingTestSuite"      "$PASCAL" "$TESTS/FormattingTestSuite"
run "TestFileOperations"      "$PASCAL" "$TESTS/TestFileOperations"
run "PointerTortureTest"      "$PASCAL" "$TESTS/PointerTortureTest"

run "TestIncDecWithVerify" "$PASCAL" "$TESTS/TestIncDecWithVerify"
run "CaseStatementSuite" "$PASCAL" "$TESTS/CaseStatementSuite"
run "BreakLoopTest"  "$PASCAL" "$TESTS/BreakLoopTest"

